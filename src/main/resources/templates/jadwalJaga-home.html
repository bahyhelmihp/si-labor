<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<object th:include="fragments/fragment :: css" th:remove="tag"></object>
<object th:include="fragments/fragment :: js" th:remove="tag"></object>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="bootstrap.min.css" rel="stylesheet" />
</head>

<body>
	<nav th:replace="fragments/fragment :: navbar"></nav>
	<br>
	<div style="margin-left: 2rem">
		<h4>Jadwal Jaga Laboratorium</h4>
	</div>
	<hr>
	<div style="margin-left: 1rem" class="col-lg-4">
		<h4>Lihat Jadwal Berdasarkan Tanggal</h4>
		<p>Pilih tanggal yang diinginkan</p>
		<form th:action="@{'/lab/jadwal-jaga/'+${tanggal}}">
			<input type="date" th:field="*{tanggal}" class="form-control" />
			<p></p>
			<button type="submit" class="btn btn-info">Lihat</button>
		</form>
	</div>
	
	<div style="margin-left: 1rem" class="col-lg-4">
		<h4>Tambah Jadwal Jaga Lab</h4>
		<form th:action="@{/lab/jadwal-jaga/tambah}" class="form-control">
			<button type="submit" class="btn btn-info">Tambah</button>
		</form>
	</div>
	<br>
	<div th:if="${jadwalJaga.isEmpty()}">
		<div>Jadwal jaga belum ada! Segera tambah jadwal jaga</div>
	</div>
	<br>
	<table id="mytable" class="table table-bordered table-striped">
		<thead>
			<tr>
				<th>ID</th>
				<th>Tanggal</th>
				<th>Waktu Mulai</th>
				<th>Waktu Selesai</th>
				<th>Nama Staff</th>
				<th>Edit</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="jj : ${jadwalJaga}">
				<td th:text="${jj.id}"></td>
				<td th:text="${jj.tanggal}"></td>
				<td th:text="${jj.start}"></td>
				<td th:text="${jj.end}"></td>
				<td th:text="${jj.namaStaff}"></td>
				<td><a th:href="@{'/lab/jadwal-jaga/ubah/' +${jj.id}}">Update
						... </a></td>
			</tr>
		</tbody>
	</table>
	<div class="pagination-container">
		<nav>
			<ul class="pagination"></ul>
		</nav>
	</div>


	<script src="jquery.min.js"></script>
	<script src="bootstrap.min.js"></script>
	<script> 
	
	var $form = $( '#dateForm' );
	var $idField = $( "#date" );

	$form.submit( function( event ) {

	  // respects th:action="@{/mycontroller/}" and appends id
	  $form.attr( 'action',  $form.attr('action') + $idField.val() );

	  // otherwise ?id=xx
	  $idField.prop( "disabled", true );

	  // submits the form in the normal way !
	  return;
	});
	var table = '#mytable'
	$('#maxRows').on('change', function(){
		$('.pagination').html('')
		var trnum = 0
		var maxRows = parseInt($(this).val())
		var totalRows = $(table+' tbody tr').length
		$(table+' tr:gt(0)').each(function(){
			trnum++
			if(trnum > maxRows){
				$(this).hide()
			}
			if trnum <= maxRows){
				$(this).show()
			}
		})
		if(totalRows >maxRows){
			var pagenum = Math.ceil(totalRows/maxRows)
			for(var i=1; i<=pagenum;){
				$('.pagination').append('<li data-page="'+i+'">\<span>'+ i++ + '<span class="sr-only">(current)</span></span>\<li>').show()
			}
		}
		$('.pagination li:first-child').addClass('active')
		$('.pagination li').on('click', fuction(){
			var pagenum = $(this).attr('data-page')
			var trIndex=0;
			$('.pagination li').removeClass('active')
			$(this).addClass('active')
			$(table+' tr:gt(0)').each(function(){
				trIndex++
				if(trIndex > (maxRows*pageNum) || trIndex<=((maxRows*pageNum)-maxRows)){
					$(this).hide()
				} else{
					$(this).show()
				}
			})
		})
	})
	$(function(){
		$('table tr:eq(0)').prepend('<th>ID</th>')
		var id = 0;
		$('table tr:gt(0)').each(function(){
			id++
			$(this).prepend('<td>'+id+'</td')
		})
	})
	
	</script>
</body>
</html>